<!DOCTYPE html>
<html>

<head>
  <style>
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 600px;
      gap: 50px;
    }

    .text-box {
      width: 800px;
      height: 200px;
    }

    .button {
      width: 200px;
      height: 50px;
      margin-top: 10px;
      margin-bottom: -30px;
    }
  </style>
</head>

<body>
  <div class="container">
    <button id="queryButton" class="button" onclick="getPoints()">查询积分</button>
    <span >https://twitter.com/chainweave</span>
    <textarea id="inputText" spellcheck="false" class="text-box" placeholder="请一行一个输入地址，某行为空或地址错误，运行时会自动忽略"
      rows="5"></textarea>
    <textarea id="outputText" class="text-box" placeholder="点击查询积分按钮，积分会显示在这里" rows="5" readonly></textarea>
  </div>

  <script>
    function getPoints() {
      var queryButton = document.getElementById("queryButton");
      queryButton.disabled = true;
      queryButton.innerText = "请稍等，查询中...";

      var inputTextarea = document.getElementById("inputText");
      var outputTextarea = document.getElementById("outputText");
      var addresses = inputTextarea.value.split("\n");
      outputTextarea.value = "";

      var promises = addresses.map(function (address) {
        var url = `https://pandora.lifeform.cc/lifeform_bsc_prod/api/avatarCartoon/getAccountInfo?address=${address}`;

        return fetch(url)
          .then(response => response.json())
          .then(data => {
            outputTextarea.value += `${address} > Point: ${data.result.allPoint}\n`;
          })
          .catch(error => {
            console.log('Error:', error);
          });
      });

      Promise.all(promises)
        .then(function () {
          queryButton.disabled = false;
          queryButton.innerText = "查询积分";
        });
    }
  </script>
</body>

</html>
